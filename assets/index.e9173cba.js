import{e as x,_ as R}from"./index.516baaea.js";/* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{d as S,r as M,b0 as P,C as H,D as O,aI as e,aH as t,aM as l,G as U,aX as L,bb as V,bQ as I,bG as K,bH as z,bR as N,bD as j,bE as G,bC as Q,bF as X,n as f}from"./arco.cd87ac27.js";import{m as q,e as E,a as J,f as W,g as Y}from"./serial.472eb3ab.js";import"./chart.19f3a5b6.js";import"./vue.a1682e6c.js";const Z={class:"container"},$=["innerHTML"],ee={name:"Backup"},te=S({...ee,setup(ue){const n=x(),c=M({status:"\u70B9\u51FB\u5907\u4EFD\u6309\u94AE\u5C06\u751F\u6210 EEPROM \u5907\u4EFD\u6587\u4EF6<br/><br/>",eepromType:""}),B=async()=>{if(n.connectState!=!0){alert("\u8BF7\u5148\u8FDE\u63A5\u624B\u53F0\uFF01");return}await q()},d=async(u,r,_=new Date+"_backup.bin")=>{await E(n.connectPort);let a=new Uint8Array(r-u);for(let o=u;o<r;o+=128){const b=await J(n.connectPort,o);a.set(b,o-u),c.status=c.status+"\u5907\u4EFD\u8FDB\u5EA6\uFF1A"+((o-u)/a.length*100).toFixed(1)+"%<br/>",f(()=>{const F=document==null?void 0:document.getElementById("statusArea");F&&(F.scrollTop=F==null?void 0:F.scrollHeight)})}c.status=c.status+"\u5907\u4EFD\u8FDB\u5EA6\uFF1A100.0%<br/>",f(()=>{const o=document==null?void 0:document.getElementById("statusArea");o&&(o.scrollTop=o==null?void 0:o.scrollHeight)}),console.log(a);const s=new Blob([a],{type:"application/octet-stream"}),i=URL.createObjectURL(s),p=document.createElement("a");p.href=i,p.download=_,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(i)},m=async(u=0)=>{await E(n.connectPort);const r=document.createElement("input");r.type="file",r.onchange=async()=>{const _=new Blob([r.files[0]],{type:"application/octet-stream"}),a=new Uint8Array(await _.arrayBuffer());for(let s=u;s<r.files[0].size+u;s+=128)await W(n.connectPort,s,a.slice(s-u,s-u+128)),c.status=c.status+"\u6062\u590D\u8FDB\u5EA6\uFF1A"+((s-u)/r.files[0].size*100).toFixed(1)+"%<br/>",f(()=>{const i=document==null?void 0:document.getElementById("statusArea");i&&(i.scrollTop=i==null?void 0:i.scrollHeight)});c.status=c.status+"\u6062\u590D\u8FDB\u5EA6\uFF1A100.0%<br/>",await Y(n.connectPort)},r.click()},y=async()=>{if(n.connectState!=!0){alert("\u8BF7\u5148\u8FDE\u63A5\u624B\u53F0\uFF01");return}await d(0,7680,"config.bin")},D=async()=>{if(n.connectState!=!0){alert("\u8BF7\u5148\u8FDE\u63A5\u624B\u53F0\uFF01");return}await d(7680,8192,"calibration.bin")},k=async()=>{if(n.connectState!=!0){alert("\u8BF7\u5148\u8FDE\u63A5\u624B\u53F0\uFF01");return}await m()},w=async()=>{if(n.connectState!=!0){alert("\u8BF7\u5148\u8FDE\u63A5\u624B\u53F0\uFF01");return}await m(7680)},C=async()=>{if(n.connectState!=!0){alert("\u8BF7\u5148\u8FDE\u63A5\u624B\u53F0\uFF01");return}let u=8192;switch(c.eepromType){case"1":u=8192;break;case"2":u=131072;break;case"3":u=262144;break;case"4":u=524288;break;default:u=8192}await d(0,u)},A=async()=>{if(n.connectState!=!0){alert("\u8BF7\u5148\u8FDE\u63A5\u624B\u53F0\uFF01");return}await m()};return(u,r)=>{const _=P("Breadcrumb"),a=L,s=V,i=I,p=K,o=z,b=N,F=j,g=G,h=Q,v=X;return H(),O("div",Z,[e(_,{items:["\u5C0F\u5DE5\u5177","\u5907\u4EFD/\u8FD8\u539F"]}),e(v,{gutter:20,align:"stretch"},{default:t(()=>[e(h,{span:24},{default:t(()=>[e(g,{class:"general-card",title:"\u5907\u4EFD/\u8FD8\u539F"},{default:t(()=>[e(b,{"default-active-key":"1"},{default:t(()=>[e(i,{key:"1",title:"\u5FEB\u6377\u5907\u4EFD"},{default:t(()=>[e(s,null,{default:t(()=>[e(a,{type:"primary",onClick:y},{default:t(()=>[l("\u5907\u4EFD\u914D\u7F6E")]),_:1}),e(a,{onClick:k},{default:t(()=>[l("\u6062\u590D\u914D\u7F6E")]),_:1}),e(a,{type:"primary",onClick:D},{default:t(()=>[l("\u5907\u4EFD\u6821\u51C6")]),_:1}),e(a,{onClick:w},{default:t(()=>[l("\u6062\u590D\u6821\u51C6")]),_:1})]),_:1})]),_:1}),e(i,{key:"2",title:"\u5B8C\u6574\u5907\u4EFD"},{default:t(()=>[e(s,null,{default:t(()=>[e(a,{type:"primary",onClick:C},{default:t(()=>[l("\u5907\u4EFD")]),_:1}),e(a,{onClick:A},{default:t(()=>[l("\u6062\u590D")]),_:1}),e(o,{modelValue:c.eepromType,"onUpdate:modelValue":r[0]||(r[0]=T=>c.eepromType=T),style:{width:"320px"},placeholder:"\u9009\u62E9EEPROM\u5927\u5C0F"},{default:t(()=>[e(p,{value:"1"},{default:t(()=>[l("8KB\uFF0864Kbit\uFF09")]),_:1}),e(p,{value:"2"},{default:t(()=>[l("128KB\uFF081Mbit\uFF09")]),_:1}),e(p,{value:"3"},{default:t(()=>[l("256KB\uFF082Mbit\uFF09")]),_:1}),e(p,{value:"4"},{default:t(()=>[l("512KB\uFF084Mbit\uFF09")]),_:1})]),_:1},8,["modelValue"]),e(a,{type:"text",onClick:B},{default:t(()=>[l("\u81EA\u52A8\u68C0\u6D4B")]),_:1})]),_:1})]),_:1})]),_:1}),e(F),U("div",{id:"statusArea",style:{height:"20em","background-color":"azure",color:"silver",overflow:"auto",padding:"20px"},innerHTML:c.status},null,8,$)]),_:1})]),_:1})]),_:1})])}}});const fe=R(te,[["__scopeId","data-v-de906e10"]]);export{fe as default};
